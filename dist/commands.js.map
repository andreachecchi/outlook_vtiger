{"version":3,"file":"commands.js","mappings":"AAOAA,OAAOC,SAAQ,WACb,IAmDFD,OAAOE,QAAQC,UAAU,UA5CzB,SAAgBC,GACd,IAAMC,EAAOL,OAAOM,QAAQC,QAAQF,KAGpCA,EAAKG,KAAKC,SAAS,QAAQ,SAACC,GAC1B,GAAIA,EAAOC,SAAWX,OAAOY,kBAAkBC,UAAW,CACxD,IAAML,EAAOE,EAAOI,MAEdC,EAAUV,EAAKU,SAAW,iBAC1BC,EAAOX,EAAKW,KAAOX,EAAKW,KAAKC,aAAe,uBAC5CC,EAAKb,EAAKa,GAAKb,EAAKa,GAAGC,KAAI,SAACC,GAAC,OAAKA,EAAEH,YAAY,IAAEI,KAAK,MAAQ,0BAG/DC,EAAa,4BAAHC,OACGR,EAAO,8BAAAQ,OACNP,EAAI,iCAAAO,OACDL,EAAE,0DAAAK,OAGff,EAAI,gBAIdgB,MAAMF,EACR,MACEG,QAAQC,MAAM,kCAAmChB,EAAOgB,MAAMC,QAElE,IAEA,IAAMA,EAAU,CACdC,KAAM5B,OAAO6B,aAAaC,4BAA4BC,qBACtDJ,QAAS,+BACTK,KAAM,aACNC,YAAY,GAIdjC,OAAOM,QAAQC,QAAQF,KAAK6B,qBAAqBC,aAAa,SAAUR,GAGxEvB,EAAMgC,WACR","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global Office */\n\nOffice.onReady(() => {\n  // If needed, Office.js is ready to be called.\n});\n\n/**\n * Shows a notification when the add-in command is executed.\n * @param event {Office.AddinCommands.Event}\n */\nfunction action(event) {\n  const item = Office.context.mailbox.item;\n\n  // Ottieni il corpo del messaggio\n  item.body.getAsync(\"text\", (result) => {\n    if (result.status === Office.AsyncResultStatus.Succeeded) {\n      const body = result.value;\n      // Recupera altre proprietÃ \n      const subject = item.subject || \"Nessun oggetto\";\n      const from = item.from ? item.from.emailAddress : \"Mittente sconosciuto\";\n      const to = item.to ? item.to.map((t) => t.emailAddress).join(\", \") : \"Destinatari sconosciuti\";\n\n      // Costruisci il messaggio\n      const rawMessage = `\n              Oggetto: ${subject}\n              Mittente: ${from}\n              Destinatari: ${to}\n              \n              Corpo:\n              ${body}\n          `;\n\n      // Visualizza l'alert\n      alert(rawMessage);\n    } else {\n      console.error(\"Errore nel recuperare il corpo:\", result.error.message);\n    }\n  });\n\n  const message = {\n    type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n    message: \"Messaggio inserito in VTiger\",\n    icon: \"Icon.80x80\",\n    persistent: true,\n  };\n\n  // Show a notification message.\n  Office.context.mailbox.item.notificationMessages.replaceAsync(\"action\", message);\n\n  // Be sure to indicate when the add-in command function is complete.\n  event.completed();\n}\n\n// Register the function with Office.\nOffice.actions.associate(\"action\", action);\n"],"names":["Office","onReady","actions","associate","event","item","context","mailbox","body","getAsync","result","status","AsyncResultStatus","Succeeded","value","subject","from","emailAddress","to","map","t","join","rawMessage","concat","alert","console","error","message","type","MailboxEnums","ItemNotificationMessageType","InformationalMessage","icon","persistent","notificationMessages","replaceAsync","completed"],"sourceRoot":""}